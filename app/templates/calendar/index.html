{% extends "base.html" %}

{% block title %}行事曆{% endblock %}

{% block content %}
 <h1>📅 我的行事曆</h1>
    <div id="calendar"></div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const calendarEl = document.getElementById("calendar");

            const calendar = new FullCalendar.Calendar(calendarEl, {
                initialView: "dayGridMonth",
                selectable: true,
                events: "/calendar/events",

                // 點選日期 -> 新增事件
                select: function (info) {
                    const title = prompt("事件標題：");
                    if (title) {
                        axios.post("/calendar/events", {
                            title: title,
                            start: info.startStr,
                            end: info.endStr || info.startStr
                        }).then(res => {
                            calendar.refetchEvents();
                        }).catch(err => {
                            alert("新增失敗");
                        });
                    }
                },

                eventClick: function(info) {
                    alert("事件：" + info.event.title);
                }
            });

            calendar.render();
        });
    </script>
{% endblock %}